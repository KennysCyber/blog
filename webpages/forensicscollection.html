<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="Content-Security-Policy"
        content="default-src 'self'; script-src 'self'; style-src 'self' 'unsafe-inline';">
    <title>TTP for DFIR Windows IA - 18gi0n's Tech Lair</title>
    <link rel="stylesheet" href="/styles.css">
    <link rel="icon" type="image/x-icon" href="/assets/images/racoon.ico">
    <style>
        html,
        body {
            margin: 0;
            padding: 0;
            height: 100%;
        }

        body {
            position: relative;
            min-height: 100vh;
        }

        .opaque-bg {
            background-color: rgba(13, 13, 13, 0.6);
            position: fixed;
            top: 50px;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 1;
        }

        .content {
            position: relative;
            z-index: 2;
            min-height: 100vh;
            padding-bottom: 20px;
        }

        .content .left-aligned-content {
            text-align: left !important;
            max-width: 800px;
            margin: 0 20px !important;
            padding: 20px 0 !important;
        }

        .content .left-aligned-content h1,
        h2,
        p,
        ul,
        ol,
        li {
            text-align: left !important;
        }

        .content .left-aligned-content a {
            color: #ff9933 !important;
            text-decoration: underline;
        }

        .content .left-aligned-content a:hover {
            color: #ff007a !important;
            text-shadow: 0 0 5px #ff007a;
        }

        .content .left-aligned-content pre {
            background: #1e1e1e;
            color: #d4d4d4;
            padding: 15px;
            border-radius: 5px;
            overflow-x: auto;
            margin: 10px 0;
            position: relative;
        }

        .content .left-aligned-content code {
            font-family: 'Consolas', 'Courier New', monospace;
            font-size: 14px;
        }

        .content .left-aligned-content .copy-btn {
            display: none;
            position: absolute;
            top: 5px;
            right: 5px;
            background: #ff9933;
            color: #fff;
            border: none;
            padding: 5px 10px;
            border-radius: 3px;
            cursor: pointer;
            font-size: 12px;
            font-family: 'Consolas', 'Courier New', monospace;
        }

        .content .left-aligned-content pre:hover .copy-btn {
            display: block;
        }

        .content .left-aligned-content .copy-btn:hover {
            background: #ff007a;
        }

        .content .left-aligned-content img {
            max-width: 100%;
            height: auto;
            border-radius: 8px;
            margin: 15px 0;
        }

        @media (max-width:600px) {
            .content .left-aligned-content {
                margin: 0 10px !important;
            }
        }
    </style>
</head>

<body>
    <!-- Nav Bar -->
    <nav>
        <ul>
            <li><a href="/index.html">Home</a></li>
            <li><a href="/about.html">About</a></li>
            <li><a href="/projects.html">Projects</a></li>
            <li><a href="/code.html">Code & Tools</a></li>
            <li><a href="/ctf.html">Write-ups</a></li>
            <li><a href="/research.html">Research</a></li>
        </ul>
    </nav>

    <!-- Main Content -->
    <div class="opaque-bg" id="opaqueBg"></div>
    <div class="content">
        <div class="left-aligned-content">
            <h1>DFIR Windows Incident Acquisition PT I</h1>

            <p>I built this collection guide/walkthrough as:</p>
            <ol>
                <li>A reinforcement of knowledge from my GCFE course</li>
                <li>A future reference for myself and others on collection of Windows evidence from devices. All tools
                    see here are free for download from vendor website.</li>
            </ol>
            <p>This is just my personal method — if things could be improved upon I would love to hear from you on X.
                (Handle on About Page)</p>

            <h2>Disclaimer</h2>
            <p>Windows OS is constantly changing with weekly patches and major version updates. Methods and techniques
                will need
                to be adapted over time. I will inevitably miss stuff — it is on the individual to validate current best
                practices.</p>

            <h2>Tools</h2>
            <ul>
                <li>Forensic Collection Drive – <a href="/webpages/fcssdsetup.html">Forensic Collection SSD Setup</a>
                </li>
                <li>
                    <p>NIST Chain of Custody Form for download: <br>
                        <a href="https://www.nist.gov/document/sample-chain-custody-formdocx" target="_blank">
                            https://www.nist.gov/document/sample-chain-custody-formdocx</a>
                    </p>
                </li>
            </ul>

            <h2>Methodology Overview</h2>
            <img src="/assets/images/FCSSD/1.png" alt="Triage Acquisition Step-by-Step Overview">
            <p>We are going to reference the above diagram throughout this guide. Memorize it — it’s an excellent cheat
                sheet if
                you ever get lost.</p>

            <p>NIST Chain of Custody Form for download: <br>
                <a href="https://www.nist.gov/document/sample-chain-custody-formdocx" target="_blank">
                    https://www.nist.gov/document/sample-chain-custody-formdocx</a>
            </p>
            <img src="/assets/images/FCSSD/28.png" alt="custody example">

            <h2>1) Memory Collection</h2>
            <ol>
                <li>Do we have the right to collect? Have you recieved authorization?</li>
                <li>Do we have ability to use LAPS or admin credentials if UAC is enforced?</li>
                <li>Connect Forensic Collection Drive.</li>
                <li>Execute DumpIt → write back to cases folder on drive.</li>
                <img src="/assets/images/FCSSD/2.png" alt="Memory folder structure">
                <img src="/assets/images/FCSSD/3.png" alt="tools">
                <img src="/assets/images/FCSSD/4.png" alt="UAC prompt for DumpIt">
                <img src="/assets/images/FCSSD/5.png" alt="DumpIt execution">
                <img src="/assets/images/FCSSD/6.png" alt="completion">
                <img src="/assets/images/FCSSD/7.png" alt="output">
                <li>Hash memory collection for integrity validation.</li>
                <img src="/assets/images/FCSSD/8.png" alt="Hashing the memory dump">
                <li>Document timestamp of collection start/finish.</li>

                <img src="/assets/images/FCSSD/27.png" alt="timeline">
            </ol>

            <h2>2) Check for Encryption</h2>
            <ol>
                <li>Run EDD (Encrypted Disk Detector) or other encryption checker tool on device to check for BitLocker
                    or other encryption. This will dictate our next actions.</li>
            </ol>
            <img src="/assets/images/FCSSD/9.png" alt="EDD folder">
            <img src="/assets/images/FCSSD/10.png" alt="EDD UAC prompt">
            <img src="/assets/images/FCSSD/11.png" alt="EDD results">

            <h2>Does Encryption Exist?</h2>

            <h3>If YES (system is encrypted)</h3>
            <p>The goal is to preserve access to the decrypted volume while power is on. I will be treating this lab as
                if the drive is encrypted when in reality it was not.</p>
            <ul>
                <li>Run KAPE triage.</li>
                <li>Collect high-value artifacts before shutdown breaks access.</li>
                <li>Hash Output for integrity validation going forward.</li>
                <li>Live logical acquisition with FTK Imager. (possible while OS is running and decrypted)</li>
                <li>Hash Output for integrity validation going forward.</li>
                <li>Controlled shutdown → full forensic image with write blocker.</li>
                <li>Hash Output for integrity validation going forward.</li>
            </ul>

            <h3>If NO (no encryption)</h3>
            <ul>
                <li>Controlled shutdown. (never yank power unless instructed)</li>
                <li>Attach hardware write blocker. (preferred)</li>
                <li>Collect triage image with KAPE. (now safe & consistent)</li>
                <li>Hash Output for integrity validation going forward.</li>
                <li>Full forensic image with FTK Imager.</li>
                <li>Hash Output for integrity validation going forward.</li>
            </ul>
            <h3>Kape Triage Image Steps</h3>
            <img src="/assets/images/FCSSD/12.png" alt="KAPE folder">
            <img src="/assets/images/FCSSD/13.png" alt="KAPE execution">
            <img src="/assets/images/FCSSD/14.png" alt="KAPE results">
            <img src="/assets/images/FCSSD/15.png" alt="KAPE results">
            <img src="/assets/images/FCSSD/16.png" alt="KAPE results">
            <img src="/assets/images/FCSSD/17.png" alt="KAPE results">
            <img src="/assets/images/FCSSD/18.png" alt="KAPE results">
            <h3>FTK Imager Logical Image Steps</h3>
            <img src="/assets/images/FCSSD/19.png" alt="FTK Imager logical start">
            <img src="/assets/images/FCSSD/20.png" alt="FTK logical imaging progress">
            <img src="/assets/images/FCSSD/21.png" alt="FTK verification">
            <img src="/assets/images/FCSSD/22.png" alt="FTK verification">
            <img src="/assets/images/FCSSD/23.png" alt="FTK verification">
            <img src="/assets/images/FCSSD/24.png" alt="FTK verification">
            <img src="/assets/images/FCSSD/25.png" alt="FTK verification">
            <img src="/assets/images/FCSSD/26.png" alt="FTK verification">



            <h2>Post-Collection</h2>
            <ol>
                <li>Make copies of evidence and move copies to forensic workstation for processing.</li>
                <li>Before processing, pause and write:
                    <ul>
                        <li>Is there a list of questions to answer?</li>
                        <li>Is there a list of statements to validate?</li>
                    </ul>
                </li>
                <li>Doing this before diving straight into processing is cruial to one saving time, but also framing
                    what you are looking for.</li>
            </ol>


            <h2>Example Actions to Investigate</h2>
            <ul>
                <li>Examine web traffic.</li>
                <li>Examine browser history & downloads.</li>
                <li>Examine USB device history.</li>
                <li>Examine prefetch, Shimcache, Amcache.</li>
                <li>Examine Event Logs (Security, System, etc.)</li>
                <li>Examine SRUM, BITS, Background Activity.</li>
            </ul>

            <h2>Final Notes & Best Practices</h2>
            <ul>
                <li>Always document every single action.</li>
                <li>Never work on originals — only verified copies.</li>
                <li>Hash everything, verify everything.</li>
                <li>When in doubt → do less, document more.</li>
            </ul>

            <p>Happy hunting!</p>
        </div>
    </div>
</body>

</html>